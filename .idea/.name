SPH3D_reworked